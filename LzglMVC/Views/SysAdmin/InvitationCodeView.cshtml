@model Models.Employee

@{
    ViewBag.Title = "生成邀请码";
    Layout = "~/Views/Shared/HRMLayout.cshtml";
}
<link href="~/Content/custom/admin-login.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.7.1.min.js"></script>
<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
<script src="~/Scripts/jquery.validate.min.js"></script>
<div class="container container-small render">
    <h1>生成邀请码</h1>
    @using (Ajax.BeginForm("Search", new AjaxOptions { UpdateTargetId = "Info", OnSuccess = "ShowEmp" }))
    {
        <div class="form-group">
            <div class="input-group">
                <input type="text" class="form-control" name="TxtSearch" placeholder="身份证号码/电话号码/姓名" />
                <div class="input-group-btn">
                    <input type="submit" class="btn btn-default" value="查 询" />
                </div>
            </div>
        </div>
    }
    <ol class="reg_error"></ol>
    <div class="form-group" id="Info"></div>
    <div id="Verify" style="display:none;">
        <p>点击下面“生成”按钮为<span id="Name"></span>分配一个邀请码：</p>
        @using (Ajax.BeginForm("ShowInvitationCode", new AjaxOptions { UpdateTargetId = "Code" }))
        {
            <div class="form-group">
                <input type="hidden" name="Empid"  id="Empid"/>
                <div class="input-group">
                    <div class="input-group-btn">
                        <input type="submit" class="btn btn-default" value="生  成" />
                    </div>
                    <div class="form-control" id="Code"></div>
                </div>
            </div>
        }
        
    </div>
</div>
<script>
    $(function () {

    });
    function ShowEmp() {
        if ($('#Info').html() != "查询失败！"
                && $('#Info').html() != "您已注册！") {     //控制器返回的数据放在“Info”这个元素里
            var emp = JSON.parse($('#Info').html());
            $('#Name').html(emp["Name"]);
            $('#Empid').val(emp["Empid"]);

            $('#Verify').css('display', 'block');   //
            $('#Info').css('display', 'none');      //
        } else {
            $('#Info').css('display', 'block');
            $('#Verify').css('display', 'none');
        }
    }
</script>